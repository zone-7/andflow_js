<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>andflow</title>

    <script src="../depends/jquery.min.js"></script>
    <script src="../depends/jsplumb.min.js"></script>
    <script src="../depends/html2canvas.min.js"></script>
    <script src="../depends/canvg.js"></script>

    <link rel="stylesheet" href="../src/css/andflow.css">
    <link rel="stylesheet" href="../src/css/andflow_themes.css">
    <link rel="stylesheet" href="../src/css/andflow_themes_action.css">

    <script src="../src/js/andflow.js"></script>
    <script src="../src/js/andflow_themes.js"></script> 
 
    <link  rel="stylesheet"  href="../src/css/demo.css" > 
    <script  src="../src/js/demo.js" ></script>
</head>
<body> 
    <div class="bander">
        <div class="logo"><img src="../img/logo.jpeg" /></div>
        <div class="title"><a href="index.html" >Andflow</a></div>
		<div class="subtitle"><a href="index.html" >首页</a> > 拓扑图</div>
        <div class="menus">
            <a href="index.html">Demos</a>
            <a href="https://github.com/zone-7/andflow_js">Github</a>
        </div>
    </div>

<div id="andflow" style="width: 100%;height: 500px;padding:0px;">
</div>
 
</body> 
<script> 
    var flowModel= {
	"code": "",
	"name": "",
	"show_action_body": "true",
	"show_action_content": "true",
	"theme": "flow_theme_icon",
	"link_type": "Flowchart",
	"params": [],
	"actions": [
		{
			"id": "4de5a6b8ce9449f3b69db390a767ecb7",
			"left": "768px",
			"top": "26px",
			"name": "mongodb",
			"params": {},
			"title": "MongoDB",
			"icon": "mongodb.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "945d6fcb8d01405fb6415e2f9cb0b13e",
			"left": "771px",
			"top": "138px",
			"name": "mysql",
			"params": {},
			"title": "Mysql",
			"icon": "mysql.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "e78ef1cab530479d8f310bffc7361c01",
			"left": "83px",
			"top": "179px",
			"name": "fireware",
			"params": {},
			"title": "防火墙",
			"icon": "fireware.png",
			"width": "49px",
			"height": "51px"
		},
		{
			"id": "7900d2c450d0459488dd04f4daa0430d",
			"left": "314px",
			"top": "269px",
			"name": "server",
			"params": {},
			"title": "服务器",
			"icon": "server.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "2b4c16b7d33d4cffb59efa32c57ea4ae",
			"left": "313px",
			"top": "170px",
			"name": "server",
			"params": {},
			"title": "服务器",
			"icon": "server.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "8d8b301346484b04a29f67e61379fb6b",
			"left": "314px",
			"top": "60px",
			"name": "server",
			"params": {},
			"title": "服务器",
			"icon": "server.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "a096e1e1c14b4fe19df4834e92f70166",
			"left": "199px",
			"top": "179px",
			"name": "nginx",
			"params": {},
			"title": "Nginx",
			"icon": "nginx.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "4f2ea312405d4bce9b718b315d89d151",
			"left": "775px",
			"top": "264px",
			"name": "redis",
			"params": {},
			"title": "Redis",
			"icon": "redis.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "7b39b46b01914094a0bd206fd9a1d516",
			"left": "848px",
			"top": "263px",
			"name": "redis",
			"params": {},
			"title": "Redis",
			"icon": "redis.png",
			"width": "50px",
			"height": "50px"
		},
		{
			"id": "5e4beeb5d8764110857f7a2778ba7d0b",
			"left": "926px",
			"top": "264px",
			"name": "redis",
			"params": {},
			"title": "Redis",
			"icon": "redis.png",
			"width": "56px",
			"height": "56px",
			"body_width": "33",
			"body_height": "18"
		}
	],
	"links": [
		{
			"source_id": "e78ef1cab530479d8f310bffc7361c01",
			"target_id": "a096e1e1c14b4fe19df4834e92f70166"
		},
		{
			"source_id": "a096e1e1c14b4fe19df4834e92f70166",
			"target_id": "2b4c16b7d33d4cffb59efa32c57ea4ae"
		},
		{
			"source_id": "a096e1e1c14b4fe19df4834e92f70166",
			"target_id": "8d8b301346484b04a29f67e61379fb6b"
		},
		{
			"source_id": "a096e1e1c14b4fe19df4834e92f70166",
			"target_id": "7900d2c450d0459488dd04f4daa0430d"
		},
		{
			"source_id": "a68e809211614a439036a4b9c9023d9f",
			"target_id": "945d6fcb8d01405fb6415e2f9cb0b13e",
			"animation": true,
			"arrows": [
				true,
				false,
				true
			]
		},
		{
			"source_id": "a68e809211614a439036a4b9c9023d9f",
			"target_id": "4de5a6b8ce9449f3b69db390a767ecb7",
			"animation": true,
			"arrows": [
				true,
				false,
				true
			]
		},
		{
			"source_id": "a68e809211614a439036a4b9c9023d9f",
			"target_id": "cb6b81cab59b445eb493706ee9f0fd44",
            // "lineStyle":"dotted",
			"animation": true,
			"arrows": [
				true,
				false,
				true
			]
		}
	],
	"groups": [
		{
			"id": "a68e809211614a439036a4b9c9023d9f",
			"name":"group",
			"left": "176px",
			"top": "33px",
			"width": "251px",
			"height": "310px",
			"members": [
				"7900d2c450d0459488dd04f4daa0430d",
				"2b4c16b7d33d4cffb59efa32c57ea4ae",
				"8d8b301346484b04a29f67e61379fb6b",
				"a096e1e1c14b4fe19df4834e92f70166"
			],
			"title": "应用服务器"
		},
		{
			"id": "cb6b81cab59b445eb493706ee9f0fd44",
			"name":"group",
			"left": "757px",
			"top": "218px",
			"width": "250px",
			"height": "144px",
			"members": [
				"4f2ea312405d4bce9b718b315d89d151",
				"7b39b46b01914094a0bd206fd9a1d516",
				"5e4beeb5d8764110857f7a2778ba7d0b"
			],
			"title": "缓存"
		}
	]
};


    var options={
        tags:tags,            //组件过滤标签列表
        metadata:metadata,    //组件元素
        flowModel:flowModel,  //流程模型
        img_path: "../img/meta/",
        show_grid: true,
        editable:true,   //是否可编辑，默认true
        render_action:function(metadata,action,html){ return html; },//节点渲染
        render_action_helper: function(metadata,html){return null},  //节点拖拉渲染
        render_state_list: function(datas){return null},             //流程状态列表渲染
        render_link:function(conn,linktype,linkdata){return null},   //连接线渲染

        //节点单击事件
        event_action_click:function(metadata,action){

             
        },
        //节点双击事件
        event_action_dblclick:function(metadata,action){

             

        },
        //连线单击事件
        event_link_click: function (link) {
        
        },
        //连线双击事件
        event_link_dblclick: function (link) {
         
        },
        //画图板单击事件
        event_canvas_click: function(e){
           
        }
    }


    andflow.newInstance("andflow",options);
    andflow.showFlow();



    //方法
    function getFlowContent(){
        var content = andflow.getFlow();
        document.getElementById("flow_content").value=JSON.stringify(content,null,'\t');
    }
    function setFlowContent(){
        var txt = document.getElementById("flow_content").value;

        if(txt.length==0){
            return;
        }
        try{

            var m = JSON.parse(txt);
            andflow.showFlow(m);
        }catch (e) {
            alert(e)
        }
    }

    function snap(){

        andflow.snap("流程");
    }


    function changeTheme(obj){
        var obj = document.getElementById("theme_select");

        var index = obj.selectedIndex; // 选中索引

        var theme = obj.options[index].value; // 选中文本
        andflow.setTheme(theme);
        andflow.reflow();
    }

    function changeLinkType(e){
        var obj = document.getElementById("link_type_select");

        var index = obj.selectedIndex; // 选中索引

        var link_type = obj.options[index].value; // 选中文本
        andflow.setLinkType(link_type);
        andflow.reflow();
    }
    function changeEditable(){
        var obj = document.getElementById("editable_select");
        var index = obj.selectedIndex; // 选中索引
        var editable = obj.options[index].value; // 选中文本
        andflow.setEditable(editable=="true"?true:false);
    }
    function changeShowContent(){
        var obj = document.getElementById("showcontent_select");
        var index = obj.selectedIndex; // 选中索引
        var visible = obj.options[index].value; // 选中文本
        andflow.setActionContentVisible(visible=="true"?true:false);

    }

</script>
</html>